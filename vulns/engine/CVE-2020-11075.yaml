schema_version: 1.2.0
id: CVE-2020-11075
aliases:
- GHSA-w4rm-w22x-h7m5
modified: 2020-06-03T15:58Z
published: 2020-05-27T22:15Z
details: In Anchore Engine version 0.7.0, a specially crafted container image manifest,
  fetched from a registry, can be used to trigger a shell escape flaw in the anchore
  engine analyzer service during an image analysis process. The image analysis operation
  can only be executed by an authenticated user via a valid API request to anchore
  engine, or if an already added image that anchore is monitoring has its manifest
  altered to exploit the same flaw. A successful attack can be used to execute commands
  that run in the analyzer environment, with the same permissions as the user that
  anchore engine is run as - including access to the credentials that Engine uses
  to access its own database which have read-write ability, as well as access to the
  running engien analyzer service environment. By default Anchore Engine is released
  and deployed as a container where the user is non-root, but if users run Engine
  directly or explicitly set the user to 'root' then that level of access may be gained
  in the execution environment where Engine runs. This issue is fixed in version 0.7.1.
severity:
- type: CVSS_V3
  score: 9.9
- type: CVSS_V2
  score: 6.5
affected:
- package:
    name: engine
    cpe: cpe:2.3:a:anchore:engine
- ranges:
  - type: GIT
    repo: https://github.com/anchore/anchore-engine
    events:
    - introduced: '0'
    - fixed: e41786901f097fd32104447a45864073105d37db
- versions:
  - 0.7.0
- database_specific:
    CWE:
    - NVD-CWE-Other
    CVSS:
      Score: 9.9
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
references:
- type: WEB
  url: https://github.com/anchore/anchore-engine/pull/431
- type: ADVISORY
  url: https://github.com/anchore/anchore-engine/security/advisories/GHSA-w4rm-w22x-h7m5
- type: REPORT
  url: https://github.com/anchore/anchore-engine/issues/430
- type: FIX
  url: https://github.com/anchore/anchore-engine/commit/e41786901f097fd32104447a45864073105d37db

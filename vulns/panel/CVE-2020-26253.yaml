schema_version: 1.2.0
id: CVE-2020-26253
aliases:
- GHSA-2ccx-2gf3-8xvv
modified: 2020-12-08T18:19Z
published: 2020-12-08T02:15Z
details: "Kirby is a CMS. In Kirby CMS (getkirby/cms) before version 3.3.6, and Kirby\
  \ Panel before version 2.5.14 there is a vulnerability in which the admin panel\
  \ may be accessed if hosted on a .dev domain. In order to protect new installations\
  \ on public servers that don't have an admin account for the Panel yet, we block\
  \ account registration there by default. This is a security feature, which we implemented\
  \ years ago in Kirby 2. It helps to avoid that you forget registering your first\
  \ admin account on a public server. In this case \u2013 without our security block\
  \ \u2013 someone else might theoretically be able to find your site, find out it's\
  \ running on Kirby, find the Panel and then register the account first. It's an\
  \ unlikely situation, but it's still a certain risk. To be able to register the\
  \ first Panel account on a public server, you have to enforce the installer via\
  \ a config setting. This helps to push all users to the best practice of registering\
  \ your first Panel account on your local machine and upload it together with the\
  \ rest of the site. This installation block implementation in Kirby versions before\
  \ 3.3.6 still assumed that .dev domains are local domains, which is no longer true.\
  \ In the meantime, those domains became publicly available. This means that our\
  \ installation block is no longer working as expected if you use a .dev domain for\
  \ your Kirby site. Additionally the local installation check may also fail if your\
  \ site is behind a reverse proxy. You are only affected if you use a .dev domain\
  \ or your site is behind a reverse proxy and you have not yet registered your first\
  \ Panel account on the public server and someone finds your site and tries to login\
  \ at `yourdomain.dev/panel` before you register your first account. You are not\
  \ affected if you have already created one or multiple Panel accounts (no matter\
  \ if on a .dev domain or behind a reverse proxy). The problem has been patched in\
  \ Kirby 3.3.6. Please upgrade to this or a later version to fix the vulnerability."
severity:
- type: CVSS_V3
  score: 5.9
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: panel
    cpe: cpe:2.3:a:getkirby:panel
- ranges:
  - type: GIT
    repo: https://github.com/getkirby-v2/panel
    events:
    - introduced: '0'
    - fixed: 7f9ac1876bacb89fd8f142f5e561a02ebb725baa
- database_specific:
    CWE:
    - CWE-346
    CVSS:
      Score: 5.9
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
references:
- type: ADVISORY
  url: https://github.com/getkirby/kirby/security/advisories/GHSA-2ccx-2gf3-8xvv
- type: WEB
  url: https://packagist.org/packages/getkirby/panel
- type: FIX
  url: https://github.com/getkirby-v2/panel/commit/7f9ac1876bacb89fd8f142f5e561a02ebb725baa
- type: WEB
  url: https://packagist.org/packages/getkirby/cms
- type: WEB
  url: https://github.com/getkirby/kirby/releases/tag/3.3.6

schema_version: 1.2.0
id: CVE-2021-41281
aliases:
- GHSA-3hfw-x7gx-437c
modified: 2021-12-14T20:54Z
published: 2021-11-23T20:15Z
details: Synapse is a package for Matrix homeservers written in Python 3/Twisted.
  Prior to version 1.47.1, Synapse instances with the media repository enabled can
  be tricked into downloading a file from a remote server into an arbitrary directory.
  No authentication is required for the affected endpoint. The last 2 directories
  and file name of the path are chosen randomly by Synapse and cannot be controlled
  by an attacker, which limits the impact. Homeservers with the media repository disabled
  are unaffected. Homeservers with a federation whitelist are also unaffected, since
  Synapse will check the remote hostname, including the trailing `../`s, against the
  whitelist. Server administrators should upgrade to 1.47.1 or later. Server administrators
  using a reverse proxy could, at the expense of losing media functionality, may block
  the certain endpoints as a workaround. Alternatively, non-containerized deployments
  can be adapted to use the hardened systemd config.
severity:
- type: CVSS_V3
  score: 7.5
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: synapse
    cpe: cpe:2.3:a:matrix:synapse
- ranges:
  - type: GIT
    repo: https://github.com/matrix-org/synapse
    events:
    - introduced: '0'
    - fixed: 91f2bd090
- database_specific:
    CWE:
    - CWE-22
    - CWE-22
    CVSS:
      Score: 7.5
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
references:
- type: WEB
  url: https://github.com/matrix-org/synapse/releases/tag/v1.47.1
- type: ADVISORY
  url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3hfw-x7gx-437c
- type: FIX
  url: https://github.com/matrix-org/synapse/commit/91f2bd090
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/N3WY56LCEZ4ZECLWV5KMAXF2PSMUB4F2/
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EU7QRE55U4IUEDLKT5IYPWL3UXMELFAS/

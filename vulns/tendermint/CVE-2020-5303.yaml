schema_version: 1.2.0
id: CVE-2020-5303
aliases:
- GHSA-v24h-pjjv-mcp6
modified: 2020-06-30T18:15Z
published: 2020-04-10T19:15Z
details: Tendermint before versions 0.33.3, 0.32.10, and 0.31.12 has a denial-of-service
  vulnerability. Tendermint does not limit the number of P2P connection requests.
  For each p2p connection, it allocates XXX bytes. Even though this memory is garbage
  collected once the connection is terminated (due to duplicate IP or reaching a maximum
  number of inbound peers), temporary memory spikes can lead to OOM (Out-Of-Memory)
  exceptions. Additionally, Tendermint does not reclaim activeID of a peer after it's
  removed in Mempool reactor. This does not happen all the time. It only happens when
  a connection fails (for any reason) before the Peer is created and added to all
  reactors. RemovePeer is therefore called before AddPeer, which leads to always growing
  memory (activeIDs map). The activeIDs map has a maximum size of 65535 and the node
  will panic if this map reaches the maximum. An attacker can create a lot of connection
  attempts (exploiting above denial of service), which ultimately will lead to the
  node panicking. These issues are patched in Tendermint 0.33.3 and 0.32.10.
severity:
- type: CVSS_V3
  score: 3.7
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: tendermint
    cpe: cpe:2.3:a:tendermint:tendermint
- ranges:
  - type: GIT
    repo: https://github.com/tendermint/tendermint
    events:
    - introduced: '0'
    - fixed: e2d6859afd7dba4cf97c7f7d412e7d8fc908d1cd
- database_specific:
    CWE:
    - CWE-787
    CVSS:
      Score: 3.7
      Severity: LOW
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L
references:
- type: ADVISORY
  url: https://github.com/tendermint/tendermint/security/advisories/GHSA-v24h-pjjv-mcp6
- type: WEB
  url: https://hackerone.com/reports/820317
- type: FIX
  url: https://github.com/tendermint/tendermint/commit/e2d6859afd7dba4cf97c7f7d412e7d8fc908d1cd

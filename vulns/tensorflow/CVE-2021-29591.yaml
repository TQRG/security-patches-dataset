schema_version: 1.2.0
id: CVE-2021-29591
aliases:
- GHSA-cwv3-863g-39vx
modified: 2021-05-19T15:08Z
published: 2021-05-14T20:15Z
details: TensorFlow is an end-to-end open source platform for machine learning. TFlite
  graphs must not have loops between nodes. However, this condition was not checked
  and an attacker could craft models that would result in infinite loop during evaluation.
  In certain cases, the infinite loop would be replaced by stack overflow due to too
  many recursive calls. For example, the `While` implementation(https://github.com/tensorflow/tensorflow/blob/106d8f4fb89335a2c52d7c895b7a7485465ca8d9/tensorflow/lite/kernels/while.cc)
  could be tricked into a scneario where both the body and the loop subgraphs are
  the same. Evaluating one of the subgraphs means calling the `Eval` function for
  the other and this quickly exhaust all stack space. The fix will be included in
  TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow
  2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still
  in supported range. Please consult our security guide(https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md)
  for more information regarding the security model and how to contact us with issues
  and questions.
severity:
- type: CVSS_V3
  score: 7.8
- type: CVSS_V2
  score: 4.6
affected:
- package:
    name: tensorflow
    cpe: cpe:2.3:a:google:tensorflow
- ranges:
  - type: GIT
    repo: https://github.com/tensorflow/tensorflow
    events:
    - introduced: '0'
    - fixed: c6173f5fe66cdbab74f4f869311fe6aae2ba35f4
  - type: GIT
    repo: https://github.com/tensorflow/tensorflow
    events:
    - introduced: '0'
    - fixed: 9c1dc920d8ffb4893d6c9d27d1f039607b326743
- database_specific:
    CWE:
    - CWE-835
    CVSS:
      Score: 7.8
      Severity: HIGH
      Code: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
references:
- type: ADVISORY
  url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cwv3-863g-39vx
- type: FIX
  url: https://github.com/tensorflow/tensorflow/commit/c6173f5fe66cdbab74f4f869311fe6aae2ba35f4
- type: FIX
  url: https://github.com/tensorflow/tensorflow/commit/9c1dc920d8ffb4893d6c9d27d1f039607b326743

schema_version: 1.2.0
id: CVE-2021-39180
aliases:
- GHSA-x95v-2pgj-9x8j
modified: 2021-09-09T12:31Z
published: 2021-08-31T18:15Z
details: OpenOLAT is a web-based learning management system (LMS). A path traversal
  vulnerability exists in versions prior to 15.3.18, 15.5.3, and 16.0.0. Using a specially
  prepared ZIP file, it is possible to overwrite any file that is writable by the
  application server user (e.g. the tomcat user). Depending on the configuration this
  can be limited to files of the OpenOlat user data directory, however, if not properly
  set up, the attack could also be used to overwrite application server config files,
  java code or even operating system files. The attack could be used to corrupt or
  modify any OpenOlat file such as course structures, config files or temporary test
  data. Those attack would require in-depth knowledge of the installation and thus
  more theoretical. If the app server configuration allows the execution of jsp files
  and the path to the context is known, it is also possible to execute java code.
  If the app server runs with the same user that is used to deploy the OpenOlat code
  or has write permissions on the OpenOlat code files and the path to the context
  is know, code injection is possible. The attack requires an OpenOlat user account
  to upload a ZIP file and trigger the unzip method. It can not be exploited by unregistered
  users. The problem is fixed in versions 15.3.18, 15.5.3 and 16.0.0. There are no
  known workarounds aside from upgrading.
severity:
- type: CVSS_V3
  score: 8.8
- type: CVSS_V2
  score: 9.0
affected:
- package:
    name: openolat
    cpe: cpe:2.3:a:frentix:openolat
- ranges:
  - type: GIT
    repo: https://github.com/OpenOLAT/OpenOLAT
    events:
    - introduced: '0'
    - fixed: 699490be8e931af0ef1f135c55384db1f4232637
  - type: GIT
    repo: https://github.com/OpenOLAT/OpenOLAT
    events:
    - introduced: '0'
    - fixed: 2cf73c972e23ccd69cc1e103e43c2c8253571d3e
  - type: GIT
    repo: https://github.com/OpenOLAT/OpenOLAT
    events:
    - introduced: '0'
    - fixed: 5668a41ab3f1753102a89757be013487544279d5
- database_specific:
    CWE:
    - CWE-22
    CVSS:
      Score: 8.8
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
references:
- type: WEB
  url: https://jira.openolat.org/browse/OO-5549
- type: ADVISORY
  url: https://github.com/OpenOLAT/OpenOLAT/security/advisories/GHSA-x95v-2pgj-9x8j
- type: FIX
  url: https://github.com/OpenOLAT/OpenOLAT/commit/699490be8e931af0ef1f135c55384db1f4232637
- type: FIX
  url: https://github.com/OpenOLAT/OpenOLAT/commit/2cf73c972e23ccd69cc1e103e43c2c8253571d3e
- type: FIX
  url: https://github.com/OpenOLAT/OpenOLAT/commit/5668a41ab3f1753102a89757be013487544279d5

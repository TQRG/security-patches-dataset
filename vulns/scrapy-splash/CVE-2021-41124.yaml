schema_version: 1.2.0
id: CVE-2021-41124
aliases:
- GHSA-823f-cwm9-4g74
modified: 2021-10-14T13:50Z
published: 2021-10-05T21:15Z
details: Scrapy-splash is a library which provides Scrapy and JavaScript integration.
  In affected versions users who use [`HttpAuthMiddleware`](http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth)
  (i.e. the `http_user` and `http_pass` spider attributes) for Splash authentication
  will have any non-Splash request expose your credentials to the request target.
  This includes `robots.txt` requests sent by Scrapy when the `ROBOTSTXT_OBEY` setting
  is set to `True`. Upgrade to scrapy-splash 0.8.0 and use the new `SPLASH_USER` and
  `SPLASH_PASS` settings instead to set your Splash authentication credentials safely.
  If you cannot upgrade, set your Splash request credentials on a per-request basis,
  [using the `splash_headers` request parameter](https://github.com/scrapy-plugins/scrapy-splash/tree/0.8.x#http-basic-auth),
  instead of defining them globally using the [`HttpAuthMiddleware`](http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth).
  Alternatively, make sure all your requests go through Splash. That includes disabling
  the [robots.txt middleware](https://docs.scrapy.org/en/latest/topics/downloader-middleware.html#topics-dlmw-robots).
severity:
- type: CVSS_V3
  score: 7.5
- type: CVSS_V2
  score: 4.3
affected:
- package:
    name: scrapy-splash
    cpe: cpe:2.3:a:zyte:scrapy-splash
- ranges:
  - type: GIT
    repo: https://github.com/scrapy-plugins/scrapy-splash
    events:
    - introduced: '0'
    - fixed: 2b253e57fe64ec575079c8cdc99fe2013502ea31
- database_specific:
    CWE:
    - CWE-200
    CVSS:
      Score: 7.5
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
references:
- type: ADVISORY
  url: https://github.com/scrapy-plugins/scrapy-splash/security/advisories/GHSA-823f-cwm9-4g74
- type: FIX
  url: https://github.com/scrapy-plugins/scrapy-splash/commit/2b253e57fe64ec575079c8cdc99fe2013502ea31

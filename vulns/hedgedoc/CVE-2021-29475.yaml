schema_version: 1.2.0
id: CVE-2021-29475
aliases:
- GHSA-pxxg-px9v-6qf3
modified: 2021-05-14T13:43Z
published: 2021-04-26T19:15Z
details: 'HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown
  editor. An attacker is able to receive arbitrary files from the file system when
  exporting a note to PDF. Since the code injection has to take place as note content,
  there fore this exploit requires the attackers ability to modify a note. This will
  affect all instances, which have pdf export enabled. This issue has been fixed by
  https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65
  and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false`
  or set `"allowPDFExport": false` in config.json can mitigate this issue for those
  who cannot upgrade. This exploit works because while PhantomJS doesn''t actually
  render the `file:///` references to the PDF file itself, it still uses them internally,
  and exfiltration is possible, and easy through JavaScript rendering. The impact
  is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json`
  file as well any other files on the filesystem. Even though the suggested Docker
  deploy option doesn''t have many interesting files itself, the `config.json` still
  often contains sensitive information, database credentials, and maybe OAuth secrets
  among other things.'
severity:
- type: CVSS_V3
  score: 10.0
- type: CVSS_V2
  score: 5.8
affected:
- package:
    name: hedgedoc
    cpe: cpe:2.3:a:hedgedoc:hedgedoc
- ranges:
  - type: GIT
    repo: https://github.com/hedgedoc/hedgedoc
    events:
    - introduced: '0'
    - fixed: c1789474020a6d668d616464cb2da5e90e123f65
- database_specific:
    CWE:
    - CWE-94
    - CWE-918
    CVSS:
      Score: 10.0
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
references:
- type: FIX
  url: https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65
- type: ADVISORY
  url: https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-pxxg-px9v-6qf3

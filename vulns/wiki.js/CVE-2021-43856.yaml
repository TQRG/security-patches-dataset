schema_version: 1.2.0
id: CVE-2021-43856
aliases:
- GHSA-rhpf-929m-7fm2
modified: 2022-01-07T19:11Z
published: 2021-12-27T18:15Z
details: Wiki.js is a wiki app built on Node.js. Wiki.js 2.5.263 and earlier is vulnerable
  to stored cross-site scripting through non-image file uploads for file types that
  can be viewed directly inline in the browser. By creating a malicious file which
  can execute inline JS when viewed in the browser (e.g. XML files), a malicious Wiki.js
  user may stage a stored cross-site scripting attack. This allows the attacker to
  execute malicious JavaScript when the file is viewed directly by other users. The
  file must be opened directly by the user and will not trigger directly in a normal
  Wiki.js page. A patch in version 2.5.264 fixes this vulnerability by adding an optional
  (enabled by default) force download flag to all non-image file types, preventing
  the file from being viewed inline in the browser. As a workaround, disable file
  upload for all non-trusted users. --- Thanks to @Haxatron for reporting this vulnerability.
  Initially reported via https://huntr.dev/bounties/266bff09-00d9-43ca-a4bb-bb540642811f/
severity:
- type: CVSS_V3
  score: 5.4
- type: CVSS_V2
  score: 3.5
affected:
- package:
    name: wiki.js
    cpe: cpe:2.3:a:requarks:wiki.js
- ranges:
  - type: GIT
    repo: https://github.com/Requarks/wiki
    events:
    - introduced: '0'
    - fixed: 79bdd4409316adf649806de3e22352297f85cee0
- database_specific:
    CWE:
    - CWE-79
    - CWE-79
    CVSS:
      Score: 5.4
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
references:
- type: FIX
  url: https://github.com/Requarks/wiki/commit/79bdd4409316adf649806de3e22352297f85cee0
- type: ADVISORY
  url: https://github.com/Requarks/wiki/security/advisories/GHSA-rhpf-929m-7fm2
- type: WEB
  url: https://github.com/Requarks/wiki/releases/tag/2.5.264

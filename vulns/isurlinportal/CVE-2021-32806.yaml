schema_version: 1.2.0
id: CVE-2021-32806
aliases:
- GHSA-q3m9-9fj2-mfwr
modified: 2021-09-20T12:23Z
published: 2021-08-02T19:15Z
details: Products.isurlinportal is a replacement for isURLInPortal method in Plone.
  Versions of Products.isurlinportal prior to 1.2.0 have an Open Redirect vulnerability.
  Various parts of Plone use the 'is url in portal' check for security, mostly to
  see if it is safe to redirect to a url. A url like `https://example.org` is not
  in the portal. The url `https:example.org` without slashes is considered to be in
  the portal. When redirecting, some browsers go to `https://example.org`, others
  give an error. Attackers may use this to redirect victims to their site, especially
  as part of a phishing attack. The problem has been patched in Products.isurlinportal
  1.2.0.
severity:
- type: CVSS_V3
  score: 6.1
- type: CVSS_V2
  score: 5.8
affected:
- package:
    name: isurlinportal
    cpe: cpe:2.3:a:plone:isurlinportal
- ranges:
  - type: GIT
    repo: https://github.com/plone/Products.isurlinportal
    events:
    - introduced: '0'
    - fixed: d4fd34990d18adf05a10dc5e2bb4b066798280ba
- database_specific:
    CWE:
    - CWE-601
    CVSS:
      Score: 6.1
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
references:
- type: ADVISORY
  url: https://github.com/plone/Products.isurlinportal/security/advisories/GHSA-q3m9-9fj2-mfwr
- type: FIX
  url: https://github.com/plone/Products.isurlinportal/commit/d4fd34990d18adf05a10dc5e2bb4b066798280ba
- type: WEB
  url: http://jvn.jp/en/jp/JVN50804280/index.html

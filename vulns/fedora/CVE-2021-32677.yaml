schema_version: 1.2.0
id: CVE-2021-32677
aliases:
- GHSA-8h2j-cgx8-6xv7
modified: 2021-06-24T14:31Z
published: 2021-06-09T18:15Z
details: FastAPI is a web framework for building APIs with Python 3.6+ based on standard
  Python type hints. FastAPI versions lower than 0.65.2 that used cookies for authentication
  in path operations that received JSON payloads sent by browsers were vulnerable
  to a Cross-Site Request Forgery (CSRF) attack. In versions lower than 0.65.2, FastAPI
  would try to read the request payload as JSON even if the content-type header sent
  was not set to application/json or a compatible JSON media type (e.g. application/geo+json).
  A request with a content type of text/plain containing JSON data would be accepted
  and the JSON data would be extracted. Requests with content type text/plain are
  exempt from CORS preflights, for being considered Simple requests. The browser will
  execute them right away including cookies, and the text content could be a JSON
  string that would be parsed and accepted by the FastAPI application. This is fixed
  in FastAPI 0.65.2. The request data is now parsed as JSON only if the content-type
  header is application/json or another JSON compatible media type like application/geo+json.
  It's best to upgrade to the latest FastAPI, but if updating is not possible then
  a middleware or a dependency that checks the content-type header and aborts the
  request if it is not application/json or another JSON compatible content type can
  act as a mitigating workaround.
severity:
- type: CVSS_V3
  score: 8.1
- type: CVSS_V2
  score: 5.8
affected:
- package:
    name: fedora
    cpe: cpe:2.3:o:fedoraproject:fedora
- ranges:
  - type: GIT
    repo: https://github.com/tiangolo/fastapi
    events:
    - introduced: '0'
    - fixed: fa7e3c996edf2d5482fff8f9d890ac2390dede4d
- versions:
  - '34'
- database_specific:
    CWE:
    - CWE-352
    CVSS:
      Score: 8.1
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
references:
- type: ADVISORY
  url: https://github.com/tiangolo/fastapi/security/advisories/GHSA-8h2j-cgx8-6xv7
- type: WEB
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MATAWX25TYKNEKLDMKWNLYDB34UWTROA/
- type: FIX
  url: https://github.com/tiangolo/fastapi/commit/fa7e3c996edf2d5482fff8f9d890ac2390dede4d

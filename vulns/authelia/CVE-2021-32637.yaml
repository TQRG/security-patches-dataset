schema_version: 1.2.0
id: CVE-2021-32637
aliases:
- GHSA-68wm-pfjf-wqp6
modified: 2021-06-09T16:36Z
published: 2021-05-28T17:15Z
details: Authelia is a a single sign-on multi-factor portal for web apps. This affects
  uses who are using nginx ngx_http_auth_request_module with Authelia, it allows a
  malicious individual who crafts a malformed HTTP request to bypass the authentication
  mechanism. It additionally could theoretically affect other proxy servers, but all
  of the ones we officially support except nginx do not allow malformed URI paths.
  The problem is rectified entirely in v4.29.3. As this patch is relatively straightforward
  we can back port this to any version upon request. Alternatively we are supplying
  a git patch to 4.25.1 which should be relatively straightforward to apply to any
  version, the git patches for specific versions can be found in the references. The
  most relevant workaround is upgrading. You can also add a block which fails requests
  that contains a malformed URI in the internal location block.
severity:
- type: CVSS_V3
  score: 10.0
- type: CVSS_V2
  score: 7.5
affected:
- package:
    name: authelia
    cpe: cpe:2.3:a:authelia:authelia
- ranges:
  - type: GIT
    repo: https://github.com/authelia/authelia
    events:
    - introduced: '0'
    - fixed: c62dbd43d6e69ae81530e7c4f8763857f8ff1dda
- database_specific:
    CWE:
    - CWE-287
    CVSS:
      Score: 10.0
      Severity: CRITICAL
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
references:
- type: ADVISORY
  url: https://github.com/authelia/authelia/security/advisories/GHSA-68wm-pfjf-wqp6
- type: FIX
  url: https://github.com/authelia/authelia/commit/c62dbd43d6e69ae81530e7c4f8763857f8ff1dda

schema_version: 1.2.0
id: CVE-2021-41272
aliases:
- GHSA-7pg2-p5vj-xp5h
modified: 2021-12-16T16:05Z
published: 2021-12-13T21:15Z
details: 'Besu is an Ethereum client written in Java. Starting in version 21.10.0,
  changes in the implementation of the SHL, SHR, and SAR operations resulted in the
  introduction of a signed type coercion error in values that represent negative values
  for 32 bit signed integers. Smart contracts that ask for shifts between approximately
  2 billion and 4 billion bits (nonsensical but valid values for the operation) will
  fail to execute and hence fail to validate. In networks where vulnerable versions
  are mining with other clients or non-vulnerable versions this will result in a fork
  and the relevant transactions will not be included in the fork. In networks where
  vulnerable versions are not mining (such as Rinkeby) no fork will result and the
  validator nodes will stop accepting blocks. In networks where only vulnerable versions
  are mining the relevant transaction will not be included in any blocks. When the
  network adds a non-vulnerable version the network will act as in the first case.
  Besu 21.10.2 contains a patch for this issue. Besu 21.7.4 is not vulnerable and
  clients can roll back to that version. There is a workaround available: Once a transaction
  with the relevant shift operations is included in the canonical chain, the only
  remediation is to make sure all nodes are on non-vulnerable versions.'
severity:
- type: CVSS_V3
  score: 7.5
- type: CVSS_V2
  score: 5.0
affected:
- package:
    name: besu
    cpe: cpe:2.3:a:linuxfoundation:besu
- ranges:
  - type: GIT
    repo: https://github.com/hyperledger/besu
    events:
    - introduced: '0'
    - fixed: 4170524ac3b45185704fcfbdeeb71b0b05dfa0a1
- versions:
  - 21.10.1
  - 21.10.0
- database_specific:
    CWE:
    - CWE-681
    CVSS:
      Score: 7.5
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
references:
- type: WEB
  url: https://github.com/hyperledger/besu/pull/3039
- type: FIX
  url: https://github.com/hyperledger/besu/commit/4170524ac3b45185704fcfbdeeb71b0b05dfa0a1
- type: ADVISORY
  url: https://github.com/hyperledger/besu/security/advisories/GHSA-7pg2-p5vj-xp5h

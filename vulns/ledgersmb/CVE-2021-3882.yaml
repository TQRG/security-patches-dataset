schema_version: 1.2.0
id: CVE-2021-3882
aliases: []
modified: 2021-10-20T18:02Z
published: 2021-10-14T09:15Z
details: LedgerSMB does not set the 'Secure' attribute on the session authorization
  cookie when the client uses HTTPS and the LedgerSMB server is behind a reverse proxy.
  By tricking a user to use an unencrypted connection (HTTP), an attacker may be able
  to obtain the authentication data by capturing network traffic. LedgerSMB 1.8 and
  newer switched from Basic authentication to using cookie authentication with encrypted
  cookies. Although an attacker can't access the information inside the cookie, nor
  the password of the user, possession of the cookie is enough to access the application
  as the user from which the cookie has been obtained. In order for the attacker to
  obtain the cookie, first of all the server must be configured to respond to unencrypted
  requests, the attacker must be suitably positioned to eavesdrop on the network traffic
  between the client and the server *and* the user must be tricked into using unencrypted
  HTTP traffic. Proper audit control and separation of duties limit Integrity impact
  of the attack vector. Users of LedgerSMB 1.8 are urged to upgrade to known-fixed
  versions. Users of LedgerSMB 1.7 or 1.9 are unaffected by this vulnerability and
  don't need to take action. As a workaround, users may configure their Apache or
  Nginx reverse proxy to add the Secure attribute at the network boundary instead
  of relying on LedgerSMB. For Apache, please refer to the 'Header always edit' configuration
  command in the mod_headers module. For Nginx, please refer to the 'proxy_cookie_flags'
  configuration command.
severity:
- type: CVSS_V3
  score: 6.8
- type: CVSS_V2
  score: 4.0
affected:
- package:
    name: ledgersmb
    cpe: cpe:2.3:a:ledgersmb:ledgersmb
- ranges:
  - type: GIT
    repo: https://github.com/ledgersmb/ledgersmb
    events:
    - introduced: '0'
    - fixed: c242f5a2abf4b99b0da205473cbba034f306bfe2
- versions:
  - 1.8.0
- database_specific:
    CWE:
    - CWE-311
    CVSS:
      Score: 6.8
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
references:
- type: WEB
  url: https://huntr.dev/bounties/7061d97a-98a5-495a-8ba0-3a4c66091e9d
- type: FIX
  url: https://github.com/ledgersmb/ledgersmb/commit/c242f5a2abf4b99b0da205473cbba034f306bfe2
- type: WEB
  url: https://ledgersmb.org/cve-2021-3882-sensitive-non-secure-cookie

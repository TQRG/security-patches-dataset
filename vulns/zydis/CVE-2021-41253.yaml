schema_version: 1.2.0
id: CVE-2021-41253
aliases:
- GHSA-q42v-hv86-3m4g
modified: 2021-11-15T13:35Z
published: 2021-11-08T22:15Z
details: Zydis is an x86/x86-64 disassembler library. Users of Zydis versions v3.2.0
  and older that use the string functions provided in `zycore` in order to append
  untrusted user data to the formatter buffer within their custom formatter hooks
  can run into heap buffer overflows. Older versions of Zydis failed to properly initialize
  the string object within the formatter buffer, forgetting to initialize a few fields,
  leaving their value to chance. This could then in turn cause zycore functions like
  `ZyanStringAppend` to make incorrect calculations for the new target size, resulting
  in heap memory corruption. This does not affect the regular uncustomized Zydis formatter,
  because Zydis internally doesn't use the string functions in zycore that act upon
  these fields. However, because the zycore string functions are the intended way
  to work with the formatter buffer for users of the library that wish to extend the
  formatter, we still consider this to be a vulnerability in Zydis. This bug is patched
  starting in version 3.2.1. As a workaround, users may refrain from using zycore
  string functions in their formatter hooks until updating to a patched version.
severity:
- type: CVSS_V3
  score: 8.1
- type: CVSS_V2
  score: 6.8
affected:
- package:
    name: zydis
    cpe: cpe:2.3:a:zyantific:zydis
- ranges:
  - type: GIT
    repo: https://github.com/zyantific/zydis
    events:
    - introduced: '0'
    - fixed: 55dd08c210722aed81b38132f5fd4a04ec1943b5
- database_specific:
    CWE:
    - CWE-122
    - CWE-457
    CVSS:
      Score: 8.1
      Severity: HIGH
      Code: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
references:
- type: FIX
  url: https://github.com/zyantific/zydis/commit/55dd08c210722aed81b38132f5fd4a04ec1943b5
- type: WEB
  url: https://huntr.dev/bounties/d2536d7d-36ce-4723-928c-98d1ee039784
- type: ADVISORY
  url: https://github.com/zyantific/zydis/security/advisories/GHSA-q42v-hv86-3m4g
- type: WEB
  url: https://huntr.dev/bounties/96b0a482-7041-45b1-9327-c6a4a8f32d3a

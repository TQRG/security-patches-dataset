schema_version: 1.2.0
id: CVE-2021-21283
aliases:
- GHSA-h3gg-7wx2-cq3h
modified: 2021-02-04T14:48Z
published: 2021-01-26T21:15Z
details: Flarum is an open source discussion platform for websites. The "Flarum Sticky"
  extension versions 0.1.0-beta.14 and 0.1.0-beta.15 has a cross-site scripting vulnerability.
  A change in release beta 14 of the Sticky extension caused the plain text content
  of the first post of a pinned discussion to be injected as HTML on the discussion
  list. The issue was discovered following an internal audit. Any HTML would be injected
  through the m.trust() helper. This resulted in an HTML injection where <script>
  tags would not be executed. However it was possible to run javascript from other
  HTML attributes, enabling a cross-site scripting (XSS) attack to be performed. Since
  the exploit only happens with the first post of a pinned discussion, an attacker
  would need the ability to pin their own discussion, or be able to edit a discussion
  that was previously pinned. On forums where all pinned posts are authored by your
  staff, you can be relatively certain the vulnerability has not been exploited. Forums
  where some user-created discussions were pinned can look at the first post edit
  date to find whether the vulnerability might have been exploited. Because Flarum
  doesn't store the post content history, you cannot be certain if a malicious edit
  was reverted. The fix will be available in version v0.1.0-beta.16 with Flarum beta
  16. The fix has already been back-ported to Flarum beta 15 as version v0.1.0-beta.15.1
  of the Sticky extension. Forum administrators can disable the Sticky extension until
  they are able to apply the update. The vulnerability cannot be exploited while the
  extension is disabled.
severity:
- type: CVSS_V3
  score: 5.4
- type: CVSS_V2
  score: 3.5
affected:
- package:
    name: sticky
    cpe: cpe:2.3:a:flarum:sticky
- ranges:
  - type: GIT
    repo: https://github.com/flarum/sticky
    events:
    - introduced: '0'
    - fixed: 7ebd30462bd405c4c0570b93a6d48710e6c3db19
- versions:
  - 0.1.0
- database_specific:
    CWE:
    - CWE-79
    CVSS:
      Score: 5.4
      Severity: MEDIUM
      Code: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
references:
- type: WEB
  url: https://github.com/flarum/sticky/pull/24
- type: WEB
  url: https://discuss.flarum.org/d/26042-security-update-to-flarum-sticky-010-beta151)
- type: ADVISORY
  url: https://github.com/flarum/sticky/security/advisories/GHSA-h3gg-7wx2-cq3h
- type: FIX
  url: https://github.com/flarum/sticky/commit/7ebd30462bd405c4c0570b93a6d48710e6c3db19
